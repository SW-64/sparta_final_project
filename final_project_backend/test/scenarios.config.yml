config:
  target: 'http://localhost:3001/api'
  phases:
    - duration: 5
      arrivalRate: 1
      name: 'Warm up'
  defaults:
    headers:
      User-Agent: 'Artillery'
  payload:
    path: './data.csv'
    fields:
      - 'email'
      - 'password'
    loadAll: false
    order: sequence

scenarios:
  - name: "Search and buy"
    flow:
      - log: "로그인 시도: 이메일 {{ email }} 비밀번호 {{ password }}"
      - post:
          url: '/v1/auth/sign-in'
          json:
            email: "{{email}}"
            password: "{{password}}"
          capture:
            - json: "$.data.accessToken"
              as: "accessToken"
      - get: 
          url: '/v1/users/me'
          headers:
            authorization: "Bearer {{accessToken}}"
      - log: "--{{user}}--"